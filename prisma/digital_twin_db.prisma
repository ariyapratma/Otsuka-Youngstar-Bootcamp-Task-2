generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/digital_twin_db"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL_DIGITAL_TWIN")
}

model mst_guest_user {
  id        String   @id @default(cuid())
  username  String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  name      String
}

model mst_role {
  id           String         @id @default(cuid())
  role_name    String         @unique
  role_level   Int
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @default(now()) @updatedAt
  tr_user_role tr_user_role[]
}

model mst_user {
  id           String         @id @default(cuid())
  name         String
  username     String         @unique
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @default(now()) @updatedAt
  tr_user_role tr_user_role[]
}

model tr_user_role {
  id        String   @id @default(cuid())
  role      String
  user      String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  mst_role  mst_role @relation(fields: [role], references: [role_name])
  mst_user  mst_user @relation(fields: [user], references: [username])

  @@index([role], map: "tr_user_role_role_fkey")
  @@index([user], map: "tr_user_role_user_fkey")
}

model tr_refresh_token {
  id        String   @id @default(cuid())
  token     String   @db.LongText
  user      String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
}

model mst_machine {
  id                    String                  @id @default(cuid())
  name                  String
  slug                  String                  @unique
  description           String?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  documentation_url     String?
  mst_function          mst_function[]
  mst_machine_parameter mst_machine_parameter[]
}

model mst_function {
  id                    Int                     @id @default(autoincrement())
  name                  String
  slug                  String                  @unique
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @default(now()) @updatedAt
  machine_slug          String?
  placeholder           Int?
  mst_machine           mst_machine?            @relation(fields: [machine_slug], references: [slug])
  mst_machine_parameter mst_machine_parameter[]

  @@index([machine_slug], map: "mst_function_machine_slug_fkey")
}

model mst_machine_parameter {
  id                     String              @id @default(cuid())
  name                   String
  slug                   String              @unique
  description            String?
  sourceType             String
  avevaTag               String?
  scadaTagId             String?
  opcServer              String?
  opcTag                 String?
  iotDataRawQuery        String?
  createdAt              DateTime            @default(now())
  updatedAt              DateTime            @updatedAt
  machine_slug           String
  uom                    String?
  valueKey               String?
  timestampKey           String?
  isConsumption          Boolean?            @default(false)
  hasTrend               Boolean?            @default(false)
  mst_function_slug      String?
  trendType              ParameterTrendType?
  tableName              String?
  node_desc              String?
  availableInDynamicForm Boolean?            @default(false)
  placeholder            Int?
  mst_machine            mst_machine         @relation(fields: [machine_slug], references: [slug])
  mst_function           mst_function?       @relation(fields: [mst_function_slug], references: [slug])

  @@index([machine_slug], map: "mst_machine_parameter_machine_slug_fkey")
  @@index([mst_function_slug], map: "mst_machine_parameter_mst_function_slug_fkey")
}

model mst_overview {
  id          Int               @id @default(autoincrement())
  slug        String            @unique
  name        String
  uom         String?
  description String?
  placeholder Int?
  area        mst_overview_area
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @default(now()) @updatedAt
}

model mst_line_subarea {
  id          Int      @id @default(autoincrement())
  slug        String
  name        String
  uom         String?
  description String?
  placeholder Int?
  sourceType  String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now()) @updatedAt
  line_slug   String?
}

model mst_line_subarea_equipment {
  id           Int      @id @default(autoincrement())
  slug         String
  name         String
  uom          String?
  description  String?
  placeholder  Int?
  sourceType   String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt
  line_slug    String?
  subarea_slug String?
}

model cache {
  id        String   @id @default(cuid())
  key       String
  value     Json
  expiredAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
}

model mst_line_parameter {
  id           Int      @id @default(autoincrement())
  slug         String
  name         String
  uom          String?
  description  String?
  placeholder  Int?
  sourceType   String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now())
  line_slug    String?
  subarea_slug String?
  db_var       String?  @db.VarChar(255)
  column_value String?  @db.VarChar(255)
}

enum ParameterTrendType {
  CONSUMPTION
  TIME_SERIES
}

enum mst_overview_area {
  PRODUCTION
  UTILITY
  OTHER
  PRODUCTION_KJY @map("PRODUCTION KJY")
}
